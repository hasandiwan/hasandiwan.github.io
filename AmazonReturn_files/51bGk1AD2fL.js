'use strict';mix_d("P13NSCCards__p13n-desktop-carousel:p13n-desktop-carousel__Q0022jkg","exports tslib @c/scoped-dom @p/A @c/metrics @c/aui-carousel @c/dom @c/remote-operations @p/a-carousel-framework @c/logger @c/aui-untrusted-ajax @c/browser-operations @c/aui-modal @c/scoped-metrics @c/aui-utils @p/jQuery".split(" "),function(ea,l,fa,wa,z,xa,ha,ya,za,Aa,Ba,Ca,Da,Ea,Fa,Ga){function F(a){return a&&"object"===typeof a&&"default"in a?a:{"default":a}}var w=F(fa),v=F(wa),Ha=F(xa),I=F(ha),N=F(ya),Ia=F(za),
A=F(Aa),V=F(Ba),U=F(Ca),Ja=F(Da),Q=F(Ea),W=F(Fa),y=F(Ga),ia={},X=function(a,c,b){void 0===c&&(c="");void 0===b&&(b=1);c=a+c;ia.hasOwnProperty(c)||(ia[c]=!0,z.count(a,(z.count(a)||0)+b))},Ka=function(a){X(v["default"].capabilities.mobile?"Card:EERU:SharedLib:mobile:render":"Card:EERU:SharedLib:desktop:render");var c=function(d,e){d={$event:{preventDefault:v["default"].$.noop,stopPropagation:v["default"].$.noop},$target:d.getContent().find('[data-a-tab-name="'+e+'"]'),data:{name:"energyEfficiencyTabSet"}};
v["default"].trigger("a:declarative:a-tabs:click",d)},b=function(d,e){var f=d&&d.$event,g=d&&d.data||{},n=g.activeTabName,h=g.modalHeight,t=g.name;f&&f.preventDefault&&f.preventDefault();f&&f.stopPropagation&&f.stopPropagation();f=e.get(t);f||(v["default"].on("a:popover:beforeShow:"+t,function(k){k.popover&&k.popover.getContent&&(k=k.popover.getContent(),k.find(".a-manually-loaded").parent().css("min-height",h),v["default"].loadDescendantImagesManually(k))}),f=e.create(d.$target,g));f.show();c(f,
n)};a.when("a-secondary-view").execute("RegisterEnergyEfficiencyEventMobile",function(d){v["default"].declarative("card-energy-efficiency-secondary-view","click",function(e){X("Card:EERU:SharedLib:mobile:click",e&&e.data&&e.data.name||"");b(e,d)})});a.when("a-modal").execute("RegisterEnergyEfficiencyEventDesktop",function(d){v["default"].declarative("card-energy-efficiency-modal","click",function(e){X("Card:EERU:SharedLib:desktop:click",e&&e.data&&e.data.name||"");b(e,d)})})},La=function(a){a.when("ready").execute("EEBadgeProductFicheResize",
function(c){var b=v["default"].$;b(".energyEfficiencyContainer").each(function(d,e){d=b(e).find(".energyEfficiencyProductFicheLabel").first();e=b(e).find("svg").first();d.parent().outerHeight()>e.outerHeight()&&(d.removeClass("a-size-small"),d.addClass("a-size-micro"),d.parent().outerHeight()>e.outerHeight()&&d.parent().css("line-height","10px"))})})},Ma={ctiList:["Website/Personalization/Report a Problem CX"],category:"Website",type:"Personalization",item:"Report a Problem CX",folder:"9c9c97c9-6f69-4dba-a55d-26045c6a3068",
group:"P13N Report a Problem CX"},Na=[{ctiList:["Website/Personalization/Similarities","Website/Detail Page/Similarities"],category:"Website",type:"Personalization",item:"Similarities",folder:"4d16d05d-9a17-4b36-b8fe-9ee159ff81de",group:"Similarities"}],Ra=function(a){var c=w["default"].cardRoot.querySelector(".p13n-report-flag"),b=U["default"].setup();b.define("showFlag","mouseover",function(){c.classList.remove("p13n-report-flag-hide")});b.define("hideFlag","mouseout",function(){c.classList.add("p13n-report-flag-hide")});
b.attach("showFlag",a);b.attach("hideFlag",a);var d=w["default"].cardRoot.querySelector(".internal-flag-form"),e=d.querySelector(".internal-flag-env-data").dataset,f=d.querySelector(".internal-flag-title-text"),g=d.querySelector(".internal-flag-description").firstElementChild,n=d.querySelector(".internal-flag-alias"),h=d.querySelector(".internal-flag-response-message"),t=function(k){k.preventDefault();k=function(p){return!p||!p.trim()};if(k(f.value)||k(g.value)||k(n.value))return Y(h,!1,"Something went wrong. One of the required fields was missing."),
!1;k=w["default"].cardRoot.querySelectorAll(".a-dynamic-image");var q;if(q=w["default"].cardRoot.querySelector(".a-carousel-heading")){var r=Oa(a,k.length);q="Internal user reported issue '"+f.value+"' with widget: "+q.innerText}else r=Pa(a),q="Internal user reported issue '"+f.value+"'";k=Qa(k,r,g.value,n.value,e);var m=Ma;Na.forEach(function(p){p.ctiList.includes(e.cti)&&(m=p)});V["default"].post("https://p13ngoals.corp.amazon.com/sims",{accepts:"text/html, application/json",contentType:"application/json;charset=UTF-8"},
{sim_params:{assigned_folder:m.folder,description:k,descriptionContentType:"text/amz-markdown-sim",extensions:{tt:{assignedGroup:m.group,category:m.category,impact:5,item:m.item,type:m.type}},tags:[{id:"internal-problem-generated"}],title:q}}).then(function(p){Y(h,!0,p)}).catch(function(p){Y(h,!1,p)});return!1};d.onsubmit=function(k){return t(k)};b=w["default"].cardRoot.querySelector(".p13n-desktop-report-problem-flag-data");if(b.dataset.name)v["default"].on("a:popover:hide:"+b.dataset.name,function(){d.reset();
h.innerText=""})},Oa=function(a,c){if(!a.dataset.aCarouselOptions)return A["default"].log("Empty ASIN List in carouselElement.dataset.aCarouselOptions","ERROR"),[];a=JSON.parse(a.dataset.aCarouselOptions).ajax.id_list;var b=w["default"].cardRoot.querySelector(".a-carousel-firstvisibleitem");b=(Number(b.value)||1)-1;return a.map(function(d){return JSON.parse(d).id}).slice(b,b+c)},Pa=function(a){return(a=a.dataset.asinList)?a.split(","):[]},Qa=function(a,c,b,d,e){for(var f="",g=0;g<a.length;g++){var n=
a[g];f+=(n?"![]("+n.src+")":"IMAGE MISSING")+"\nASIN: "+(c[g]?c[g]:"ASIN MISSING")+"\n\n"}return"**This SIM-T ticket is created by the 'Report a Problem' internal tool. To know more, here's its wiki: https://w.amazon.com/bin/view/Personalization/CoreRecommendations/Projects/Canaries/Report-a-Problem-UX-on-P13NWidget/UserGuide/**\n\n**Alias:** ["+(d+"](https://phonetool.amazon.com/users/"+d+")\n**Comment:** "+b+"\n\n**Widget Group ID:** "+e.widgetGroupId+"\n**Strategy ID:** "+e.strategyId+"\n**CTI:** "+
e.cti+"\n**Facets:** ")+(e.facets+"\n**Content Reftag:** "+e.reftag+"\n"+(""!==e.baseAsin?"**Page ASIN:** "+e.baseAsin+"\n":"")+"\n**SessionID:** ")+(e.sessionId+"\n**MarketplaceID:** "+e.marketplaceId+"\n**Device Type:** "+e.deviceType+"\n\n**List of ASINs:**\n\n")+f},Y=function(a,c,b){c?(a.classList.remove("a-color-error"),b.responseBody&&"object"===typeof b.responseBody?b.responseBody.response&&b.responseBody.response.id?a.innerHTML="Success, here's the <a href=\"https://t.corp.amazon.com/"+b.responseBody.response.id+
'" target="_blank">SIM-T ticket</a> you created.':(A["default"].log("Fail to find the id of the SIM-T ticket created in the response body of response data.","ERROR"),a.innerText="Success, but we could not find the link to the SIM-T ticket."):(A["default"].log("The response body of response data is not an object.","ERROR"),a.innerText="Success, but we could not find the link to the SIM-T ticket.")):(a.classList.add("a-color-error"),a.innerText="string"===typeof b?b:"Oops! Something went wrong. Please try again.")},
Sa={setupModal:function(a){return l.__awaiter(void 0,void 0,void 0,function(){var c;return l.__generator(this,function(b){c=w["default"].cardRoot.querySelector(".p13n-report-problem-modal-root");if(!c)return[2];Ra(a);return[2]})})}},Ta=N["default"].setup(["getLazyLoadDeliveryMessage"]),Ua=function(a){return l.__awaiter(void 0,void 0,void 0,function(){var c,b,d;return l.__generator(this,function(e){switch(e.label){case 0:c=a.querySelectorAll("[data-udm-asin]:not([data-requested=true])");if(!c.length)return[2,
void 0];b=[];c.forEach(function(f){var g=f.dataset.udmAsin,n=f.dataset.udmMerchantId,h=f.dataset.udmBlockSize,t=f.dataset.udmLayoutSize,k="true"===f.dataset.udmBadgeWithoutProgramName;g&&n&&h&&(b.push({asin:g,merchantId:n,blockSize:h,layoutSize:t,badgeWithoutProgramName:k}),f.dataset.requested="true")});return b.length?[4,Ta.getLazyLoadDeliveryMessage({lazyLoadDeliveryMessageViewModels:b})]:[2,void 0];case 1:return d=e.sent(),[2,[].slice.call(d.querySelectorAll("[data-udm-asin]:not([data-requested=true])"))]}})})},
Va=function(a){return l.__awaiter(void 0,void 0,void 0,function(){var c;return l.__generator(this,function(b){switch(b.label){case 0:return[4,Ua(a)];case 1:c=b.sent();if(!c)return[2];c.map(function(d){var e=d.dataset.udmAsin,f=d.dataset.udmMerchantId;e&&f&&(e=a.querySelector("[data-udm-asin="+e+"][data-udm-merchant-id="+f+"]"))&&(e.outerHTML=d.innerHTML)});return[2]}})})},ja=[],Wa=function(a){var c=Array.prototype.slice.call(a.querySelectorAll("[data-metrics]"));c.push(a);c.forEach(function(b){if(b&&
b.dataset&&b.dataset.metrics&&(!b.id||!ja.includes(b.id))){var d=JSON.parse(b.dataset.metrics),e;for(e in d)d.hasOwnProperty(e)&&z.count(e,d[e]);b.removeAttribute("data-metrics");b.id&&ja.push(b.id)}})},ka=/(?=[ \-\/])|(?=[\u3105-\u312F])|(?=[\u31A0-\u31BA])|(?=[\u4E00-\u9FD5])|(?=[\u3400-\u4DB5])|(?=[\uF900-\uFAFF])|(?=[\u3040-\u309F])|(?=[\u30A0-\u30FF])|(?=[\u3190-\u319F])/,la=/[^\/\-\[\]():\s]/,Xa=function(a){var c=v["default"].$("<div>")[0];c.classList.add("p13n-sc-offscreen-truncate");var b=
parseInt(a.getAttribute("data-rows")||"2",10),d=function(){var g=a.innerHTML;a.innerHTML="&hellip;";var n=a.clientHeight;a.innerHTML=g;return n}();if(b){if(d){var e=function(g){c.innerHTML=g;return Math.round(c.clientHeight/d)<=b},f=function(g,n){g=g.split(n);var h=Math.floor(a.clientWidth/12),t=function(q){c.classList.add("p13n-sc-offscreen-truncate");c.style.overflow="hidden";c.textContent=q;a.appendChild(c);q=a.clientWidth>=a.scrollWidth;a.removeChild(c);return q},k=function(q){var r=q.length-
h;q.trim().length>h&&!t(q)&&Array.prototype.slice.call(q).map(function(m,p){return p>h&&p<=r&&la.test(m)?"&shy;"+m:m});return q};return g.map(function(q){return k(q)}).join("")};return{truncate:function(){var g=a.innerHTML.trim(),n=a.textContent||"";g=f(g,ka);a.appendChild(c);if(e(g))a.removeChild(c),a.innerHTML=g;else{var h=g.split(ka);for(var t=1,k=h.length,q,r,m=0;t!==k;)if(q=Math.floor((k+t)/2),r=h.slice(0,q).join("")+"&hellip;",e(r)){if(1>=k-q){for(m=q;0<m&&!la.test(h[m-1]);)m--;break}t=q}else k=
q;h=0===m?void 0:h.slice(0,m).join("")+"&hellip;";h?(a.innerHTML=h,a.setAttribute("title",n),a.setAttribute("aria-label",n)):(A["default"].log("Unable to successfully truncate line "+g,"ERROR"),a.removeChild(c))}}}}A["default"].log("Truncation element does not have a line height or it is zero","ERROR")}else A["default"].log("Truncation element missing necessary line number data","ERROR")},Ya=function(a){var c=Array.prototype.slice.call(a.getElementsByClassName("p13n-sc-truncate"));a=a.getElementsByClassName("p13n-sc-truncate-fallback");
(window.CSS&&CSS.supports&&CSS.supports("-webkit-line-clamp","1")?c:c.concat(Array.prototype.slice.call(a))).filter(function(b){return!!b.offsetParent}).map(function(b){var d=Xa(b);d&&(d.truncate(),b.classList.add("p13n-sc-truncated"),b.classList.remove("p13n-sc-truncate"),b.classList.remove("p13n-sc-truncate-fallback"),b.className=b.className.replace(/p13n-sc-line-clamp-\d/g,""))})},Za=function(a){a.querySelectorAll(".a-carousel-viewport").forEach(function(c){c=c.querySelectorAll(".a-carousel-card");
for(var b=null,d=0;d<c.length;d++){var e=c[d].getAttribute("aria-roledescription");if(null!==e&&""!==e){b=e;break}}b=b||"slide";c.forEach(function(f){f.getAttribute("aria-roledescription")!==b&&f.setAttribute("aria-roledescription",b)})})},Z=function(a){return 0===Math.floor(a/10)?"0"+a.toString():a.toString()},$a=function(a){var c=Date.now();var b=a.dayscountdowntoendtemplate,d=a.expiredstring,e=a.hourscountdowntoendtemplate,f=a.minutescountdowntoendtemplate;a=parseInt(a.endtime,10);if(c<=a){d=null;
var g=a-c;a=Math.floor(g/864E5);var n=Math.floor(g/36E5);c=Math.floor(g/6E4%60);g=Math.floor(g/1E3%60);if(1<a&&b&&(d=b,null!==d))return b=d.replace("${daysCount}",a.toString());f&&(d=0===n?f:e);return null!==d?(b=d.replace("_hours_",Z(n)),b=b.replace("_minutes_",Z(c)),b=b.replace("_seconds_",Z(g))):""}return d},ab=function(a){if(null!==a&&a.dataset.endtime){a.dataset.callbackAttached="true";var c=setInterval(function(){a.innerText===a.dataset.expiredstring&&clearInterval(c);var b=$a({dayscountdowntoendtemplate:a.dataset.dayscountdowntoendtemplate||
"",endtime:a.dataset.endtime||"",expiredstring:a.dataset.expiredstring||"",hourscountdowntoendtemplate:a.dataset.hourscountdowntoendtemplate||"",minutescountdowntoendtemplate:a.dataset.minutescountdowntoendtemplate||""});a.innerText=b},1E3)}},R=function(a,c){return a.querySelector("[class*="+c+"]")},bb=function(a,c,b){a=JSON.parse(a);a.adCreativeMetaData=c.adCreativeMetaData;a.feedbackFormContainerId=b;return encodeURI(JSON.stringify(a))},cb=function(a,c,b){return l.__awaiter(void 0,void 0,void 0,
function(){var d,e,f,g,n,h,t;return l.__generator(this,function(k){d="adFeedbackModal_"+a;k=(null===(t=R(c,"ad-feedback-modal-container"))||void 0===t?void 0:t.className)||"";e="."+c.className+" ."+k.replace(" ",".");g=(f=b().adCreativeMetaData.adCreativeDetails)?f.length:0;n={a11yOpenMessage:"",width:Math.max(560,125*g+130)};try{return h=Ja["default"].create(d,e,n),[2,h]}catch(q){throw z.count("adfeedback:cards:clientDesktop:modalCreation:failure",1),Error("Modal Creation Failed : "+q);}})})},fb=
function(a,c,b,d,e,f,g){var n="rtl"===document.getElementsByTagName("html")[0].dir?"ad-feedback-loading-spinnner-rtl":"ad-feedback-loading-spinnner";var h=R(I["default"].cardRoot,n);a.on("beforeShow",function(){return l.__awaiter(void 0,void 0,void 0,function(){var t,k;return l.__generator(this,function(q){switch(q.label){case 0:return t=db(a,c,b),[4,a.render(function(r){var m="250px",p=b().adCreativeMetaData.adCreativeDetails;p&&2>p.length&&(m="150px");h.style.marginTop=m;r.innerHTML="";m=r.appendChild;
p=document.getElementsByTagName("html")[0].dir;var u=I["default"].createElement("div"),x=I["default"].createElement("div");u.innerHTML=e;"rtl"===p?(u.setAttribute("style",'box-sizing: border-box; color: rgb(15, 17, 17); font-family: "Amazon Ember", Arial, sans-serif; font-size: 16px; font-weight: 700; line-height: 24px; margin-bottom: 0px; margin-left: 28px; margin-right: 0px; margin-top: 0px; min-height: 56px; padding-bottom: 16px; padding-left: 0px; padding-right: 25px; padding-top: 16px; text-align: right; text-rendering: optimizelegibility; visibility: visible;'),
x.setAttribute("style",'background-attachment: scroll; background-clip: border-box; background-color: rgb(240, 242, 242); background-image: linear-gradient(to left, #EFEFEF 66.72%, #FFFFFF); background-origin: padding-box; background-position: 0% 0%; background-position-x: 0%; background-position-y: 0%; background-repeat: repeat; background-size: auto; border-bottom-color: rgb(213, 217, 217); border-bottom-left-radius: 0px; border-bottom-right-radius: 0px; border-top-left-radius: 8px; border-top-right-radius: 8px; box-sizing: border-box; color: rgb(15, 17, 17); display: block; font-family: "Amazon Ember", Arial, sans-serif; font-size: 14px; line-height: 20px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 0px; padding-left: 24px; padding-right: 24px; padding-top: 0px; position: relative; text-align: right; visibility: visible; z-index: 10;')):
(u.setAttribute("style",'box-sizing: border-box; color: rgb(15, 17, 17); font-family: "Amazon Ember", Arial, sans-serif; font-size: 16px; font-weight: 700; line-height: 24px; margin-bottom: 0px; margin-left: 0px; margin-right: 28px; margin-top: 0px; min-height: 56px; padding-bottom: 16px; padding-left: 25px; padding-right: 0px; padding-top: 16px; text-align: left; text-rendering: optimizelegibility; visibility: visible;'),x.setAttribute("style",'background-attachment: scroll; background-clip: border-box; background-color: rgb(240, 242, 242); background-image: linear-gradient(to right, #EFEFEF 66.72%, #FFFFFF); background-origin: padding-box; background-position: 0% 0%; background-position-x: 0%; background-position-y: 0%; background-repeat: repeat; background-size: auto; border-bottom-color: rgb(213, 217, 217); border-bottom-left-radius: 0px; border-bottom-right-radius: 0px; border-top-left-radius: 8px; border-top-right-radius: 8px; box-sizing: border-box; color: rgb(15, 17, 17); display: block; font-family: "Amazon Ember", Arial, sans-serif; font-size: 14px; line-height: 20px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 0px; padding-left: 24px; padding-right: 24px; padding-top: 0px; position: relative; text-align: left; visibility: visible; z-index: 10;'));
x.appendChild(u);m.call(r,x);m=document.getElementsByTagName("html")[0].dir;p=I["default"].createElement("div");"rtl"===m?p.setAttribute("style","padding-bottom: 16px; padding-right: 50px ; padding-top: 16px; justify-content: center; align-items: center;"):p.setAttribute("style","padding-bottom: 16px; padding-left: 50px ; padding-top: 16px; justify-content: center; align-items: center;");eb(h,p,d,t,f);r.appendChild(p)})];case 1:return q.sent(),(k=document.querySelector(".a-button-close"))&&k.setAttribute("aria-label",
g),[2]}})})})},db=function(a,c,b){b=b();var d=b.adCreativeMetaData.adCreativeDetails;null===d||void 0===d?void 0:d.sort(function(e,f){return e.adCreativeIndex<f.adCreativeIndex?-1:1});return bb(c,b,a.id)},eb=function(a,c,b,d,e){c.appendChild(a);"function"==typeof z.uet&&z.uet("bb","adfeedback:cards:clientDesktop:fetchFormContent:time",{wb:1});V["default"].post("/af/multi-creative/feedback-form",{accepts:"application/json",contentType:"application/json",additionalHeaders:{"Accept-Language":""===b?
"en-US":b}},{pl:d,deviceType:"desktop"}).then(function(f){return l.__awaiter(void 0,void 0,void 0,function(){var g,n,h;return l.__generator(this,function(t){"function"==typeof z.uet&&z.uet("be","adfeedback:cards:clientDesktop:fetchFormContent:time",{wb:1});z.count("adfeedback:cards:clientDesktop:fetchFormContent:success",1);g=I["default"].createElement("div");g.innerHTML=String(f.responseBody);for(n=0;n<g.children.length;++n)h=g.children[n],"SCRIPT"===h.tagName?aa("script",h,c):"LINK"===h.tagName?
aa("link",h,c):aa("div",h,c);c.removeChild(a);return[2]})})}).catch(function(){"function"==typeof z.uet&&z.uet("be","adfeedback:cards:clientDesktop:fetchFormContent:time",{wb:1});z.count("adfeedback:cards:clientDesktop:fetchFormContent:failure",1);c.innerHTML=e});"function"==typeof z.uex&&z.uex("ld","adfeedback:cards:clientDesktop:fetchFormContent:time",{wb:1})},aa=function(a,c,b){var d=I["default"].createElement(a);d.innerHTML=c.innerHTML;c.getAttributeNames().forEach(function(e){d.setAttribute(e,
c.getAttribute(e)||"")});b.appendChild(d)},ma={},gb=function(a,c){return l.__awaiter(void 0,void 0,void 0,function(){var b,d,e,f,g,n,h,t,k;return l.__generator(this,function(q){b=R(a,"ad-feedback-primary-link");d=c().adFeedbackLabelId;e=U["default"].setup();f="open-modal"+d;g=c().adCreativeMetaData.adCreativeDetails;n=a.dataset;h=n.isDsaEnabled;t=n.weblabTreatment;k=String(h);"undefined"===k&&(k=g&&0<g.length?g[0].selectionSignals?"true":"false":"false");"true"===k&&"T1"!==t&&(k="false");e.attach(f,
b);e.define(f,"click",function(){return l.__awaiter(void 0,void 0,void 0,function(){var r;return l.__generator(this,function(m){switch(m.label){case 0:return(r=ma[d])?[3,2]:[4,cb(d,a,c)];case 1:r=m.sent();var p=a.dataset,u=p.formHeaderText,x=p.dsaFormHeaderText;fb(r,p.adFeedbackPayload,c,p.currentLocale,"true"===k?x:u,p.formLoadErrorText,p.closeButtonAriaText);ma[d]=r;m.label=2;case 2:return r.show(),[2]}})})});try{b.addEventListener("keydown",function(r){if(" "===r.key||"Enter"===r.key)r.preventDefault(),
b.click()})}catch(r){console.log("Couldnt add keydown event listner")}return[2]})})},hb=function(a,c){var b=U["default"].setup(),d="mouse-enter"+c;c="mouse-leave"+c;var e=R(a,"ad-feedback-primary-link"),f=R(a,"ad-feedback-text-desktop"),g=R(a,"ad-feedback-sprite");b.attach(d,e);b.define(d,"mouseenter",function(){g.style.backgroundPosition="0px -12px";f.style.color="#111111"});b.attach(c,e);b.define(c,"mouseleave",function(){g.style.backgroundPosition="0px 0px";f.style.color="#555"})},ba=function(a){return l.__awaiter(void 0,
void 0,void 0,function(){var c,b,d,e;return l.__generator(this,function(f){switch(f.label){case 0:return f.trys.push([0,3,,4]),c=a(),b=w["default"].cardRoot.getElementsByClassName("adFeedbackMainComponent_"+c.adFeedbackLabelId)[0],d=b.dataset.isSponsoredLabelActive,"false"===(d||"false").toLowerCase()?[2]:[4,hb(b,c.adFeedbackLabelId)];case 1:return f.sent(),[4,gb(b,a)];case 2:return f.sent(),[3,4];case 3:throw e=f.sent(),z.count("adfeedback:cards:clientDesktop:enableAdFeedback:failure",1),Error("Failed to call enableAdFeedback for desktop client : "+
e);case 4:return[2]}})})},ib=function(a){a=I["default"].cardRoot.getElementsByClassName(a);return Array.prototype.slice.call(a)},kb=function(a,c){ib("p13n-sc-unified-ad-label").forEach(function(b){b={adFeedbackLabelId:b.dataset.adFeedbackLabelId||"",adFeedbackAsin:b.dataset.adFeedbackAsin||"",adId:b.dataset.adId||"",campaignId:b.dataset.campaignId||"",advertiserId:b.dataset.advertiserId||"",marketplaceId:b.dataset.marketplaceId||"",isLocationUsed:b.dataset.locationUsed||"",isInterestBasedAdsOptOut:b.dataset.interestBased||
"",title:b.dataset.asinTitle||"",price:b.dataset.asinPrice||"",currencyCode:b.dataset.currencyCode||""};b.adFeedbackLabelId&&b.adFeedbackAsin&&b.adId&&b.campaignId&&b.advertiserId&&b.marketplaceId&&b.isLocationUsed&&b.isInterestBasedAdsOptOut&&jb(b,c,a)})},jb=function(a,c,b){var d="mobile"===c?na(a.adFeedbackLabelId,oa(a,"mobile")):na(a.adFeedbackLabelId,oa(a,"desktop"));b(function(){return d})},oa=function(a,c){var b=c=l.__assign,d=a.adFeedbackAsin,e=a.adId,f=a.campaignId,g=a.title;var n=a.price;
var h=a.currencyCode;n=n&&h?{amount:n,currencyCode:h}:void 0;h=a.advertiserId;var t=a.marketplaceId;b=b.call(l,{},{asin:d,adCreativeIndex:0,adId:e,campaignId:f,title:g,priceInfo:n,advertiserIdNS:h&&t?"axiom."+t+"."+h:void 0});d=a.isLocationUsed;a=a.isInterestBasedAdsOptOut;a=void 0===d||void 0===a?void 0:{version:1,context:!0,location:"true"===d,pastActivity:"true"===a?0:1};return{adCreativeDetails:[c.call(l,b,{selectionSignals:a})]}},na=function(a,c){return{adFeedbackLabelId:a,adCreativeMetaData:c}},
lb={initCarousel:function(a){return l.__awaiter(void 0,void 0,void 0,function(){var c,b,d;return l.__generator(this,function(e){c=(a||{}).afterPageLoaded;b=w["default"].cardRoot.classList.contains("p13n-sc-shoveler")?[w["default"].cardRoot]:Array.prototype.slice.call(w["default"].cardRoot.getElementsByClassName("p13n-sc-shoveler"));d=N["default"].setup(["getCarouselItems"]);if(null===b||void 0===b||!b.length)return[2];b.forEach(function(f){return l.__awaiter(void 0,void 0,void 0,function(){var g,
n,h,t,k,q;return l.__generator(this,function(r){switch(r.label){case 0:g=f.dataset||{};n="true"===g.showlazyloaddeliverymessage;h=function(){v["default"].loadDynamicImage("[data-name]='"+q+"' .p13n-sc-dynamic-image");Ya(f);Wa(f);null===c||void 0===c?void 0:c(f);var m=window.P;Ka(m);La(m);Za(f);n&&Va(f)};h();if(f.classList.contains("p13n-carousel-initialized"))return[2];f.classList.add("p13n-carousel-initialized");t=Ia["default"].getCarousel(ha.unscope(f));k=Ha["default"].getCarousel(f);q=t.getAttr("name");
return[4,Promise.all([k.initialized,Sa.setupModal(f)])];case 1:return r.sent(),v["default"].on("a:carousel:"+q+":change:pageSize",h),v["default"].on("a:carousel:"+q+":change:loading",h),v["default"].on("a:carousel:"+q+":change:animating",h),v["default"].on("a:carousel:"+q+":change:fetchedItems",h),k.attachRemoteOperation(function(m){var p=m.indexes;m=m.ids;var u=d,x=u.getCarouselItems,C=l.__assign,D=l.__assign({},g),L=String(p[0]||0);var J=p[0]||0,E,K,S=0,G=g.aCarouselOptions?g.aCarouselOptions:void 0;
if(G&&(G=JSON.parse(G),G=null===(E=null===G||void 0===G?void 0:G.ajax)||void 0===E?void 0:E.id_list))for(E=0;E<J&&E<G.length;E++){var H=JSON.parse(G[E]);"true"===((null===(K=null===H||void 0===H?void 0:H.metadataMap)||void 0===K?0:K.isSponsoredProduct)?H.metadataMap.isSponsoredProduct:"false")&&(S+=1)}return x.call(u,C.call(l,D,{ids:m,indexes:p,offset:L,adOffset:S}))}),[2]}})})});return[2]})})}},mb={updateHandler:function(a){var c;void 0===a&&(a=w["default"].cardRoot);a=Array.prototype.slice.call(a.querySelectorAll('[class*="dealsCardDealTimer"]:not([data-callback-attached])'));
try{for(var b=l.__values(a),d=b.next();!d.done;d=b.next())ab(d.value)}catch(f){var e={error:f}}finally{try{d&&!d.done&&(c=b.return)&&c.call(b)}finally{if(e)throw e.error;}}}},nb={enableDesktopUnifiedAdLabels:function(){kb(ba,"desktop")}},ob={enableAdFeedback:function(a){var c=w["default"].cardRoot.querySelector("[data-sponsoredhybridwidgetcontext]");c&&(c=c.getAttribute("data-sponsoredhybridwidgetcontext"))&&a(c).catch(function(b){return A["default"].log("enableAdFeedbackDelegate: Error occurred: "+
(b instanceof Error?b.message:JSON.stringify(b)))})}},pb={initializeQuantitySelectorWidgets:function(){v["default"].trigger("quantity-selector-widget:loadStatesAndInitialize")}},B=function(a,c){a&&(c?W["default"].show(a):W["default"].hide(a))},ca=function(a,c){return(a=c.getElementsByClassName(a))&&1===a.length?a[0]:void 0},O=function(a,c){void 0===c&&(c=1);z.count(a,(z.count(a)||0)+c)},qb=function(){function a(c,b,d,e,f,g,n,h){var t=this;this.throttledScrollAction=v["default"].throttle(function(){return l.__awaiter(t,
void 0,void 0,function(){return l.__generator(this,function(k){switch(k.label){case 0:return[4,this.getNextBatchIfBottomInView()];case 1:return k.sent(),[2]}})})},200);this.containerDataset=this.getContainerDataset(c);this.bottomOfListElement=b;this.containerForInsertion=d;this.insertFetchedItems=e;this.errorFetchingItemsElement=g;this.fetchAsinsRemoteOperation=f;this.spinnerFetchingItemsElement=n;this.batchSize=h||8;this.processingStatus={batchFailureCount:0,currentIndex:Number(c.dataset.indexOffset)||
0,individualBatchAttemptsCount:0,isAllContentLoaded:!1,isProcessing:!1}}a.prototype.getContainerDataset=function(c){if(!c.dataset||!c.dataset.asinList)throw Error("Dataset not present or does not contain required data!");return{asinList:JSON.parse(c.dataset.asinList),linkParameters:c.dataset.linkParameters||"{}",reftag:c.dataset.reftag||"",strategyId:c.dataset.strategyId||"",widgetGroupId:c.dataset.widgetGroupId||""}};a.prototype.getNextItemBatch=function(c){var b=this;this.processingStatus.individualBatchAttemptsCount+=
1;this.processingStatus.isProcessing=!0;var d=this.processingStatus.currentIndex;if(d>=this.containerDataset.asinList.length)return this.processingStatus.isAllContentLoaded=!0,Promise.resolve(void 0);B(this.spinnerFetchingItemsElement,!0);d=this.containerDataset.asinList.slice(d,d+this.batchSize);var e=d.map(function(f,g){return g+b.processingStatus.currentIndex});return this.fetchAsinsRemoteOperation({ids:d,indexes:e,linkparameters:this.containerDataset.linkParameters,offset:e[0].toString(),reftagprefix:this.containerDataset.reftag}).then(function(f){B(b.spinnerFetchingItemsElement,
!1);b.insertFetchedItems(c,f);b.processingStatus.batchFailureCount=0;b.processingStatus.currentIndex+=b.batchSize;b.processingStatus.individualBatchAttemptsCount=0;b.processingStatus.isProcessing=!1}).catch(function(f){console.log("Error fetching items: "+f);if(2<=b.processingStatus.individualBatchAttemptsCount){b.processingStatus.batchFailureCount+=1;if(2<=b.processingStatus.batchFailureCount){b.processingStatus.isProcessing=!0;B(b.spinnerFetchingItemsElement,!1);B(b.errorFetchingItemsElement,!0);
return}b.processingStatus.currentIndex+=b.batchSize}void b.getNextItemBatch(c)})};a.prototype.getNextBatchIfBottomInView=function(){return l.__awaiter(this,void 0,void 0,function(){return l.__generator(this,function(c){switch(c.label){case 0:if(this.processingStatus.isProcessing)return[3,3];this.processingStatus.isProcessing=!0;return W["default"].onScreen(this.bottomOfListElement,500)&&!this.processingStatus.isAllContentLoaded&&2>this.processingStatus.batchFailureCount?[4,this.getNextItemBatch(this.containerForInsertion)]:
[3,2];case 1:return c.sent(),[3,3];case 2:this.processingStatus.isProcessing=!1,c.label=3;case 3:return[2]}})})};a.prototype.isInErrorState=function(){return 2<=this.processingStatus.batchFailureCount};a.prototype.resetLazyLoading=function(){this.processingStatus.batchFailureCount=0;B(this.errorFetchingItemsElement,!1)};return a}(),pa=function(a,c,b){void 0===c&&(c=function(){});void 0===b&&(b=function(){});return l.__awaiter(void 0,void 0,void 0,function(){return l.__generator(this,function(d){switch(d.label){case 0:return a.dataset.event?
[4,rb(a.dataset.event,a,c,b)]:[3,2];case 1:return d.sent(),[3,5];case 2:return a.dataset.url?[4,sb(a.dataset.url,c,b)]:[3,4];case 3:return d.sent(),[3,5];case 4:A["default"].log("Element is missing dataset.url or dataset.event attribute"),b(),d.label=5;case 5:return[2]}})})},rb=function(a,c,b,d){return l.__awaiter(void 0,void 0,void 0,function(){var e,f,g,n,h,t;return l.__generator(this,function(k){switch(k.label){case 0:e=function(q){return l.__awaiter(void 0,void 0,void 0,function(){var r,m;return l.__generator(this,
function(p){switch(p.label){case 0:return r=function(u){u?b():(A["default"].log("Failed to call PPDS custom API"),d())},m=function(u){A["default"].log("Caught error when calling PPDS custom API: "+u.stack);d()},[4,q().then(r).catch(m)];case 1:return p.sent(),[2]}})})};f=function(q){return l.__awaiter(void 0,void 0,void 0,function(){var r;return l.__generator(this,function(m){switch(m.label){case 0:if(!c.dataset.asin)return[3,2];r={asin:c.dataset.asin};return[4,e(q.bind(null,r))];case 1:return m.sent(),
[3,3];case 2:A["default"].log("Element was missing required data: asin"),d(),m.label=3;case 3:return[2]}})})};g=a;switch(g){case "NOT_INTERESTED":return[3,1];case "DELETE_NOT_INTERESTED":return[3,5]}return[3,7];case 1:if(!c.dataset.asin)return[3,3];n={asin:c.dataset.asin,expirationTime:tb(c.dataset.suppressiondays),reason:c.dataset.reason,strategyId:c.dataset.strategyId||c.dataset.strategyid,widgetGroupId:c.dataset.widgetGroupId||c.dataset.widgetgroupid};h=N["default"].setup(["recordNotInterested"]);
return[4,e(h.recordNotInterested.bind(null,n))];case 2:return k.sent(),[3,4];case 3:A["default"].log("Element was missing required data: asin"),d(),k.label=4;case 4:return[3,8];case 5:return t=N["default"].setup(["deleteNotInterested"]),[4,f(t.deleteNotInterested)];case 6:return k.sent(),[3,8];case 7:return A["default"].log("Invalid PPDS event type: "+a),d(),[3,8];case 8:return[2]}})})},sb=function(a,c,b){return l.__awaiter(void 0,void 0,void 0,function(){return l.__generator(this,function(d){switch(d.label){case 0:return[4,
V["default"].post(a,{accepts:"text/html,*/*",contentType:"application/x-www-form-urlencoded"}).then(function(){c()}).catch(function(e){A["default"].log("Failed to call AJAX endpoint "+a+" with error: "+e.message,"ERROR");b()})];case 1:return d.sent(),[2]}})})},tb=function(a){if(a&&(a=Number.parseInt(a,10),!(0>=a||(a=new Date(Date.now()+864E5*a),Number.isNaN(a.getTime())))))return a.toISOString()},ub=function(a,c,b,d,e,f,g,n,h,t){var k=a.getElementsByClassName(d)[0],q=a.getElementsByClassName(e)[0],
r=n?a.getElementsByClassName(n)[0]:void 0,m=a.querySelector(f);if(!q||!k||!m)throw Error("One or more elements to record feedback are not present.");d=function(p,u){p&&(p.onclick=function(){return l.__awaiter(void 0,void 0,void 0,function(){var x;return l.__generator(this,function(C){switch(C.label){case 0:return[4,pa(p,function(){u&&h?h():!u&&t&&t();B(m,!1);B(q,u);B(k,!u);r&&(r.style.opacity=u?"0.3":"1");g&&O(g.prefix+":record-feedback:success")},function(){console.log("Failed to record feedback on click");
B(m,!0);g&&O(g.prefix+":record-feedback:failure")})];case 1:return C.sent(),g&&(x=u?g.primaryAction:g.secondaryAction,O(g.prefix+":record-feedback:"+x)),[2]}})})})};c=ca(c,a);d(c,!0);a=ca(b,a);d(a,!1)},vb=function(a,c,b,d,e){var f=function(t){return N["default"].setup(["getCanariesFeedbackReasons"]).getCanariesFeedbackReasons(t)},g=d.getElementsByClassName("p13n-not-interested-reasons")[0],n=ca("p13n-not-interested-success-message",d),h=d.querySelector("#p13n-record-feedback-error-message");return function(){e.includes(a)||
e.push(a);g?(B(n,!1),g.hasChildNodes()||f({asin:a,strategyId:c,widgetGroupId:b}).then(function(t){Array.prototype.slice.call(t.getElementsByClassName("p13n-feedback-reasons-option")).forEach(function(k){function q(){return l.__awaiter(this,void 0,void 0,function(){return l.__generator(this,function(m){pa(k,function(){B(h,!1);B(g,!1);B(n,!0)},function(){console.log("Failed to record feedback reason on click");h&&B(h,!0)});return[2]})})}var r=k.getElementsByTagName("input")[0];r.addEventListener("keypress",
function(m){return l.__awaiter(void 0,void 0,void 0,function(){return l.__generator(this,function(p){"Enter"===m.key&&q();return[2]})})});r.addEventListener("click",function(m){return l.__awaiter(void 0,void 0,void 0,function(){return l.__generator(this,function(p){0!==m.screenX&&0!==m.screenY&&q();return[2]})})})});g.appendChild(t)}),B(g,!0)):B(n,!0)}},wb=function(a,c){return function(){var b=c.indexOf(a);-1<b&&c.splice(b,1)}},xb={feedbackModalInit:function(a,c){var b={prefix:"p13n-desktop-feedback-modal",
primaryAction:"not-interested",secondaryAction:"remove-not-interested"},d=[],e=w["default"].cardRoot.querySelector(".p13n-desktop-canaries-kebab-data");if(e){O(b.prefix+":kebab:render");e.onclick=function(){return O(b.prefix+":kebab:click")};w["default"].cardRoot.querySelector(".p13n-desktop-feedback-modal-link").onclick=function(){return O(b.prefix+":modal:open")};var f=w["default"].cardRoot.querySelector(".p13n-ni-iyr-redirect");f&&(f.onclick=function(){return O(b.prefix+":iyr:click")});f=w["default"].cardRoot.getElementsByClassName("p13n-canaries-desktop-feedback-modal")[0];
if(!f)throw Error("Dataset not present or does not contain required data!");var g=f.querySelector("#endOfList"),n=w["default"].cardRoot.getElementsByClassName("p13n-desktop-feedback-modal-faceouts-list")[0],h=f.querySelector("#p13n-desktop-feedback-modal-loading-items"),t=f.querySelector("#p13n-desktop-feedback-modal-error-loading-items"),k=new qb(e,g,n,function(p,u){var x;if(u.hasChildNodes()){u=Array.from(u.childNodes);try{for(var C=l.__values(u),D=C.next();!D.done;D=C.next()){var L=D.value;u=L;
var J=u.getElementsByClassName("p13n-individual-feedbackButton")[0];ub(u,"p13n-individual-feedbackButton","p13n-feedback-undo-button","p13n-desktop-feedback-modal-initial-faceout","p13n-desktop-feedback-modal-undo-faceout","#p13n-record-feedback-error-message",b,"p13n-feedback-list-asin-image",vb(J.dataset.asin||"",e.dataset.strategyId||"",e.dataset.widgetGroupId||"",u,d),wb(J.dataset.asin||"",d));p.appendChild(L);J.dataset.strategyId=e.dataset.strategyId;J.dataset.widgetGroupId=e.dataset.widgetGroupId}}catch(K){var E=
{error:K}}finally{try{D&&!D.done&&(x=C.return)&&x.call(C)}finally{if(E)throw E.error;}}}},function(p){return N["default"].setup(["getCanariesFeedbackModalItems"]).getCanariesFeedbackModalItems(p)},t,h);w["default"].cardRoot.querySelector(".p13n-desktop-feedback-modal-link").addEventListener("click",function(){return l.__awaiter(void 0,void 0,void 0,function(){return l.__generator(this,function(p){switch(p.label){case 0:return""!==n.innerHTML||k.isInErrorState()?[3,2]:[4,k.getNextItemBatch(n)];case 1:return p.sent(),
[3,4];case 2:if(!k.isInErrorState())return[3,4];k.resetLazyLoading();return[4,k.getNextItemBatch(n)];case 3:p.sent(),p.label=4;case 4:return[2]}})})});f.addEventListener("wheel",k.throttledScrollAction);var q=function(p){return N["default"].setup(["refreshCard"]).refreshCard(p)};f=e.dataset.uniqueId;g=e.dataset.input;!g&&(h=w["default"].cardRoot.querySelector(".p13n-desktop-canaries-wrapper-data"),null===h||void 0===h?0:h.dataset)&&(g=h.dataset.input);var r=JSON.parse(g||"{}"),m=w["default"].cardRoot.querySelector("#p13n-desktop-feedback-modal-close-message");
v["default"].on("a:popover:hide:p13n-desktop-feedback-modal_"+f,function(){return l.__awaiter(void 0,void 0,void 0,function(){var p,u,x,C,D,L,J,E,K,S;return l.__generator(this,function(G){p=e.querySelector(".p13n-feedback-popover-kebab-button");p.focus();if(0<d.length&&r&&r.content){u=r.content.recommendations;x=[];try{for(C=l.__values(u),D=C.next();!D.done;D=C.next())L=D.value,J=L.id,E=d.indexOf(J),0>E&&x.push(L)}catch(H){K={error:H}}finally{try{D&&!D.done&&(S=C.return)&&S.call(C)}finally{if(K)throw K.error;
}}x.length<c?m?(m.style.display="inline",m.style.position="absolute",m.style.top=(w["default"].cardRoot.offsetHeight-m.offsetHeight)/2+"px",m.style.right=(w["default"].cardRoot.offsetWidth-m.offsetWidth)/2+"px"):A["default"].log("Could not find the changeover element for message surfacing"):(r.content.recommendations=x,q(r).then(function(H){w["default"].cardRoot.innerHTML=H.outerHTML;a()}).catch(function(H){A["default"].log("Error fetching items: "+H)}))}return[2]})})})}}},qa=document.body.style.overflow,
M=function(a){return a.find("#cpf-sidesheet-content-container")},yb=function(a){var c,b;null!==(c=a.$target)&&void 0!==c&&c.length&&(null===(b=a.$target)||void 0===b?0:b.hasClass("cpf-sidesheet-anchor-end"))&&v["default"].delay(function(){P().find("a[href], button").first().focus()},0)},zb=function(a){var c;null!==(c=a.$target)&&void 0!==c&&c.length&&v["default"].delay(function(){v["default"].$(document.activeElement).hasClass("cpf-sidesheet-anchor-start")&&P().find("a[href], button").last().focus()},
0)},ra=function(){document.body.style.overflow=qa?qa:"";y["default"]("#cpf-sidesheet-background").hide();var a=P();a.attr("aria-hidden","true");y["default"]("#cpf-sidesheet").attr("aria-hidden","true");M(a).attr("aria-hidden","true");y["default"]("#a-page").attr("aria-hidden","false");T(a).hide();Ab()},P=function(){return y["default"]("#cpf-sidesheet-containerempty-div")},T=function(a){return a.find("#cpf-sidesheet-secondary-content-container")},Ab=function(){var a=y["default"]("#cpf-sidesheet").width()+
50;Bb({right:"-"+a+"px"},function(){y["default"]("#cpf-sidesheet").hide()})},Cb=function(){y["default"]("#cpf-sidesheet").show(function(){v["default"].animate(y["default"]("#cpf-sidesheet"),{right:"0"},300,"ease-out",function(){y["default"]("#cpf-sidesheet-close").show()})})},Bb=function(a,c){v["default"].animate(y["default"]("#cpf-sidesheet"),a,300,"ease-out",c)},Db=function(a){a=U["default"].setup().define;a("cpf-side-sheet-open","click",function(c){var b;c=null===(b=c.currentTarget)||void 0===
b?void 0:b.getAttribute("cpf-side-sheet-content-id");var d=P();b=y["default"]("#"+c);d&&0!==d.length||(c=y["default"](document.createElement("div")),c.attr("id","cpf-sidesheet-containerempty-div"),d=w["default"].cardRoot.getElementsByClassName("cpf-sidesheet-container")[0].innerHTML,c.append(d),y["default"]("body").prepend(c),d=c);b&&0!==b.length&&(M(d).html(b.html()),b=P(),M(b).show(),b.attr("aria-hidden","false"),y["default"]("#cpf-sidesheet").attr("aria-hidden","false"),M(b).attr("aria-hidden",
"false"),y["default"]("#a-page").attr("aria-hidden","true"),y["default"]("body").css("overflow","hidden"),y["default"]("#cpf-sidesheet-background").show(),Cb(),b.find(".cpf-sidesheet-close-button").focus())});v["default"].declarative("cpf-side-sheet-close","click",function(c){ra()});v["default"].declarative("cpf-side-sheet-secondary-open","click",function(c){var b,d=P();c=null===(b=c.data)||void 0===b?void 0:b.preloadDomId;b=y["default"]("#"+c);d.find(".cpf-sidesheet-close-button").focus();M(d).hide();
M(d).attr("aria-hidden",!0);T(d).show().html(b.html());T(d).attr("aria-hidden",!1)});v["default"].declarative("cpf-bottom-sheet-secondary-back","click",function(c){c=P();c.find(".cpf-sidesheet-close-button").focus();M(c).show();M(c).attr("aria-hidden",!1);T(c).hide();T(c).attr("aria-hidden",!0)});v["default"].declarative("cpf-sidesheet-capture","keydown",function(c){"keydown"!==c.type||27!==c.$event.keyCode&&27!==c.$event.key||ra()});v["default"].declarative("cpf-sidesheet-capture","focusin",function(c){yb(c)});
v["default"].declarative("cpf-sidesheet-capture","focusout",function(c){zb(c)})},Fb=function(a){return l.__awaiter(void 0,void 0,void 0,function(){var c,b,d,e,f,g,n,h,t,k,q,r,m;return l.__generator(this,function(p){switch(p.label){case 0:c=null!==(k=a.widgetLabelClass)&&void 0!==k?k:"hybrid-widget-sponsored-label";b=null!==(q=a.productLabelClass)&&void 0!==q?q:"hybrid-sponsored-label";d=JSON.parse(a.sponsoredHybridWidgetContextJson);e=null!==(r=d.painterId)&&void 0!==r?r:"unknown";f=null!==(m=d.slotId)&&
void 0!==m?m:"unknown";Q["default"].count(e+"."+f+".initAdFeedback",1);if(g=Eb(c,b,a.enableWidgetAdFeedback,e,f))return[2,g];n=0;h=sa(b);t=h.map(function(u){u=da(u);if(u.adFeedbackLabelId&&u.adFeedbackAsin&&u.adId&&u.campaignId&&u.advertiserId&&u.marketplaceId&&u.isLocationUsed&&u.isInterestBasedAdsOptOut)return a.enableProductAdFeedback(u);n++;return Promise.resolve()});Q["default"].count(e+"."+f+".productAdFeedback",h.length);Q["default"].count(e+"."+f+".invalidProductAdFeedbackPayload",n);return[4,
Promise.all(t)];case 1:return p.sent(),[2]}})})},Eb=function(a,c,b,d,e){void 0===a&&(a="hybrid-widget-sponsored-label");void 0===c&&(c="hybrid-sponsored-label");a=sa(a);Q["default"].count(d+"."+e+".widgetAdFeedbackLabel",a.length);if(1<a.length)throw Error("More than one ad feedback label found for widget");if(1===a.length){a=da(a[0]);if(!a.adFeedbackLabelId)throw Q["default"].count(d+"."+e+".missingWidgetAdFeedbackLabel",1),Error("Missing required attribute adFeedbackLabelId");c=I["default"].cardRoot.querySelectorAll("[class*='"+
c+"']");var f=[];c.forEach(function(g){g=da(g);f.push(g)});Q["default"].count(d+"."+e+".widgetAdFeedback",c.length);return b(a.adFeedbackLabelId,f)}},da=function(a){return{adFeedbackLabelId:a.dataset.adFeedbackLabelId||"",adFeedbackAsin:a.dataset.adFeedbackAsin||"",adId:a.dataset.adId||"",campaignId:a.dataset.campaignId||"",advertiserId:a.dataset.advertiserId||"",marketplaceId:a.dataset.marketplaceId||"",isLocationUsed:a.dataset.locationUsed||"",isInterestBasedAdsOptOut:a.dataset.interestBasedAdsOptOut||
"",title:a.dataset.asinTitle||"",price:a.dataset.asinPrice||"",currencyCode:a.dataset.currencyCode||""}},ta=function(a){var c=a.adFeedbackAsin,b=a.adId,d=a.campaignId,e=a.title;var f=a.price;var g=a.currencyCode;f=f&&g?{amount:f,currencyCode:g}:void 0;g=a.advertiserId;a=a.marketplaceId;return{asin:c,adCreativeIndex:0,adId:b,campaignId:d,title:e,priceInfo:f,advertiserIdNS:g&&a?"axiom."+a+"."+g:void 0}},ua=function(a,c){var b;if(void 0!==a&&void 0!==c)return b={version:1,context:!0},b.location="true"===
a,b.pastActivity="true"===c?0:1,b},sa=function(a){a=I["default"].cardRoot.getElementsByClassName(a);return Array.prototype.slice.call(a)},Ib=function(a){return l.__awaiter(void 0,void 0,void 0,function(){return l.__generator(this,function(c){return[2,Fb({widgetLabelClass:"hybrid-widget-sponsored-label",enableWidgetAdFeedback:Gb,productLabelClass:"hybrid-sponsored-label",enableProductAdFeedback:Hb,sponsoredHybridWidgetContextJson:a})]})})},Gb=function(a,c){c=c.map(function(d){return l.__assign(l.__assign({},
ta(d)),{selectionSignals:ua(d.isLocationUsed,d.isInterestBasedAdsOptOut)})});var b={adFeedbackLabelId:a,adCreativeMetaData:{adCreativeDetails:c}};return ba(function(){return b})},Hb=function(a){var c=[l.__assign(l.__assign({},ta(a)),{selectionSignals:ua(a.isLocationUsed,a.isInterestBasedAdsOptOut)})],b={adFeedbackLabelId:a.adFeedbackLabelId,adCreativeMetaData:{adCreativeDetails:c}};return ba(function(){return b})},va=function(){return l.__awaiter(void 0,void 0,void 0,function(){var a,c;return l.__generator(this,
function(b){switch(b.label){case 0:return a=lb.initCarousel({afterPageLoaded:function(d){mb.updateHandler(d);pb.initializeQuantitySelectorWidgets();"true"===fa.cardRoot().dataset.useSponsoredAdsCardsLibrary?ob.enableAdFeedback(Ib):nb.enableDesktopUnifiedAdLabels()}}),c=xb.feedbackModalInit(va,1),Db(),[4,a];case 1:return b.sent(),[4,c];case 2:return b.sent(),[2]}})})};ea._operationNames=["getCarouselItems","getCanariesFeedbackModalItems","refreshCard","deleteNotInterested","recordNotInterested"];ea.card=
va});
